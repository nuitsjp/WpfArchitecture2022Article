2022年版実践WPF業務アプリケーションのアーキテクチャ【設計編　設計】 ～ ドメイン駆動設計＆Clean Architectureとともに ～

# リード文（400字以内）

先日、「[2022年版実践WPF業務アプリケーションのアーキテクチャ【設計編　前編】～ドメイン駆動設計＆Clean Architectureとともに～](https://codezine.jp/article/detail/16953)」という記事を公開させていただきました。こちらの記事では、初期のドメインビュー・ユースケースビューから、アーキテクチャを設計していくための土台となる初期の論理ビュー・実装ビュー・配置ビュー・データビュー・プロセスビューの設計を行い、全体の大まかな設計を行いました。その結果、個別の非機能要件やユースケースを個別に設計できる状態になりました。

今回は、非機能要件とユースケースから代表的なものを選定して詳細を蒸留します。最後に開発者ビューで、利用者側の要件からは出てきにくい、開発上に必要となる設計、テスト設計などを実施します。

最終的に非機能要件が満たされた状態で、代表的なユースケースの基本シナリオを実現し、テストが実装できるところまでを説明します。本稿を完走することで、同一パターンのユースケースの実装が並行に行える状態となります。

では、設計を始めましょう！

# ソースコード

実際に動作するソースコードは、GitHub上に公開しています。ぜひご覧ください。

- [https://github.com/nuitsjp/WpfArchitecture2022](https://github.com/nuitsjp/WpfArchitecture2022)

ビルドや実行方法については、リンク先のREADME.mdをご覧ください。

また実際に動作させるためにはつぎの2つのライセンスが必要です。

* [ComponentOne for WPF Edition 2022v2](https://www.grapecity.co.jp/developer/componentone/wpf)
* [SPREAD for WPF 4.0J](https://www.grapecity.co.jp/developer/spread-wpf)

これらは試用ライセンスを発行していただくことができます。

T.B.D.　正式な試用ライセンスの申告方法をここに記載する

本稿は、本稿だけで読み進められるように記載していますが、すべてのコードを詳細に解説しているわけではありません。本稿を読んだ後、あらためて動作させつつコードと本稿を読み比べていただければ、理解が深まるかと思います。

# 前提条件

本稿はWPFアプリケーションのアーキテクチャ設計について記載したものです。すでに公開されている「見積編」および「設計編　前編」が前提となります。未読なものがあれば、そちらからまずはお読みください。

- [見積編](https://codezine.jp/article/detail/16953)
- [設計編　前編](https://codezine.jp/article/detail/16953)


本稿にはサーバーサイドの設計も一部含まれていますが、見積編にも記載した通り、サーバーサイドについてはWPFアプリケーションを設計する上で、必要最低限の範囲に限定しています。サーバーサイドの実現方式は、オンプレ環境なのかクラウド環境なのか？といった容易などで大きく変わってきます。そしてWPFアプリケーションから見た場合には本質的な問題ではありません。サーバーサイドまで厳密に記載すると話が発散し過ぎてしまい、WPFアプリケーションのアーキテクチャにフォーカスすることが難しくなるため、あくまで参考程度にご覧ください。

また本稿ではAdventureWorks社の業務のうち、発注業務システムのアーキテクチャとなります。特定業務は発注業務に限定されますが、認証などの複数の業務にまたがったアーキテクチャの実現についても言及しています。

本稿は以下の環境を前提に記載しています。  

* Visual Studio 2022 Version 17.4.0
* Docker Desktop 4.14.0
* Docker version 20.10.20
* SQL Server 2022-latest(on Docker)
* [ComponentOne for WPF Edition 2022v2](https://www.grapecity.co.jp/developer/componentone/wpf)
* [SPREAD for WPF 4.0J](https://www.grapecity.co.jp/developer/spread-wpf)
* Test Assistant Pro 1.123
* .NET 6.0.11

本稿のサンプルは .NET 6で構築しますが、.NET Framework 4.6.2以上（.NET Standard 2.0水準以上）であれば同様のアーキテクチャで実現可能です。ただし一部利用しているパッケージのバージョンを当てなおす必要があるかもしれません。

# 想定読者

次の技術要素の基本をある程度理解していることを想定しています。

* C#  
* WPF  
* Docker
* SQL Server

これらの基本的な解説は、本稿では割愛しますが、知らないと理解できないという訳でもありません。

また下記の2つも概要は理解できていることが好ましいです。

* Clean Architecture
* ドメイン駆動設計（DDD）

Clean Architectureについては、筆者のブログである「[世界一わかりやすいClean Architecture](https://www.nuits.jp/entry/easiest-clean-architecture-2019-09)」をあわせて読んでいただけると、本稿のアーキテクチャの設計意図が伝わりやすいかと思います。

ドメイン駆動設計の適用範囲については、本文内でも、つど解説いたします。

# 本稿の構成

本稿はつぎの構成で進めます。

1. 非機能要件の実現
   1. 認証アーキテクチャ
   2. 例外処理アーキテクチャ
   3. ロギングアーキテクチャ
2. 代表的なユースケースの実現
   1. 「再発注する」ユースケースの実現
3. 開発者ビューの設計

