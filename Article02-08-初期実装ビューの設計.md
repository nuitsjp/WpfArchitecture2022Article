# 初期実装ビューの設計

論理ビューで抽出されたオブジェクトを、どのようにコンポーネントに分割配置するか設計します。ここでいうコンポーネントとはVisual Studio上のプロジェクト（.csproj）のことです。

論理ビューで抽出されたオブジェクトを、どのプロジェクトに配置するか決定することが実装ビューの設計です。

もちろんモノリシックなプロジェクトでも作れない事はありませんが、.NETの場合は名前空間スコープがないので、実装時にあやまった依存を防ぐためにはプロジェクトを分割する必要があります。そのため依存関係を制限したい単位でプロジェクトを分割する必要があります。

今回はつぎのような方針でプロジェクトを定義します。

1. トップレベルの名前空間はAdventureWorksとし、AdventureWorksドメインのオブジェクトを定義する
2. 購買ドメインの名前空間はAdventureWorks.Purchasingとし、購買ドメインのオブジェクトを定義する
3. インターフェイスの実装クラスを別プロジェクトに分離する場合、インターフェイル名前空間＋実装アーキテクチャ名前空間に定義する（例：IVendorRepositoryのDB実装の名前空間はAdventureWorks.Purchasing.SqlServer）

3は実装アーキテクチャじゃなくて、Repositoryを配置するプロジェクトなので、AdventureWorks.Purchasing.Repositoryのような名前も考えられます。しかし、実際にはDB操作する実装と、リモートを呼び出す実装の2つがあり、名前が被ってしまいます。またデータをクラウドに永続化する場合、業務のトランザクションデータはRDBに、画像のようなバイナリーデータはBLOBサービスに置くといった形で、リポジトリーの保管先が別アーキテクチャになる可能性もあります。そのため、具象クラスを実装するコンポーネントの名称には、実装するアーキテクチャを表す名前にしておいた方が良いと考えています。

上記を基本として、論理ビューのオブジェクトをそれぞれのプロジェクトに配置した実装ビューが、つぎの通りです。

![](/Article02/スライド39.PNG)

|プロジェクト|説明|
|--|--|
|AdventureWorks|AdventureWorksドメインのドメインオブジェクトを含む|
|AdventureWorks.Purchasing|購買ドメインのドメインオブジェクトを含む|
|AdventureWorks.Purchasing.View|購買ドメインのViewを含む|
|AdventureWorks.Purchasing.ViewModel|購買ドメインのViewModelを含む|
|AdventureWorks.Purchasing.MagicOnion|クライアントからサーバー上のリポジトリー実装を呼び出すためのMagicOnionClient|
|AdventureWorks.Purchasing.MagicOnion.Service|リポジトリーをクライアントに対してgRPCインターフェイスで公開するWeb API実装|

論理レイヤーモデルと並べてみると、正しく設計されているのが分かりやすいかと思います。

![](/Article02/スライド42.PNG)

適切な単位でプロジェクト分割されていて、依存方向も問題ないことが見て取れます。

## 配置ビューの更新

さて、新しいコンポーネントが登場したので配置ビューを更新しましょう。

これで初期実装ビューの設計はいったん完了とします。