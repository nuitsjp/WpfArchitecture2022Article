# アーキテクチャ設計の構成

過去に記載した「[実践WPF業務アプリケーションのアーキテクチャ【概要編】 ～ マイクロソフト公式サンプルデータベースAdventureWorksを題材に](https://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=&cad=rja&uact=8&ved=2ahUKEwijj-XDpvD9AhVtS2wGHVCWACcQFnoECB4QAQ&url=https%3A%2F%2Fcodezine.jp%2Farticle%2Fdetail%2F10727&usg=AOvVaw0nFMOXzm1dpqOjvMuyfoHA)」では、アーキテクチャをRational Unified Process（RUP）にて提唱された4＋1ビューを用いて記載・説明しました。

![](/Article02/スライド20.PNG)

ただ4+1ビューではつぎの2つに端を発する設計が導きにくいと感じてきました。

- ドメイン・コンテキスト
- 非機能要件

そこで今回は「ドメインビュー」と「非機能要件ビュー」を追加し、4+3ビューとして記載・説明したいと思います。

![](/Article02/スライド9.PNG)

「ドメインビュー」「ユースケースビュー」「非機能要件ビュー」がインプットとなって、「論理ビュー」「配置ビュー」「実装ビュー」「プロセスビュー」にて実現方式を設計します。

まず設計対象となる購買ドメインを中心としたドメインとコンテキストを整理し、ユースケースビューでアーキテクチャを決定するために重要となるユースケースを、非機能要件ビューで重要な非機能要件を明確にします。

この後は、ユースケースビューで抽出された重要なユースケースをどのように実装するのか、実装ビューで設計しながら、論理ビューと配置ビューに整理します。実装ビュー・論理ビュー・配置ビューは、行ったり来たりしながら昇華します。いずれかから先に完成させるというものではありません。

アーキテクチャ設計書は、つぎ順に書くと私としては読みやすいです。

|No.|ビュー|説明|
|--|--|--|
|1|ドメインビュー|ビジネスの俯瞰レベルを表現するビュー。そのため最初に説明したい。コンポーネント分割やコンポーネントの依存関係を導くために利用する。|
|2|ユースケースビュー|ユースケースの一覧に対し、パターンの整理とパターンを代表するユースケースを設計する。|
|3|非機能要件ビュー|非機能要件の一覧に対して、アーキテクチャ上の検討要否を設計する。|
|4|配置ビュー|UMLの配置図・コンポーネント図を用いて全体のノード・要素の配置を設計する。|
|5|論理ビュー|ソフトウェアの論理レイヤー構成やレイヤー内のオブジェクト配置を設計する。|

# 本稿の構成

前述の構成は、アーキテクチャ設計書としては短時間で理解しやすいと思います。

しかし本稿の目的は、設計の過程や、なぜそう設計するのか説明することが主眼となります。そのため設計書としてのアーキテクチャ設計とは、やや異なったアプローチで記載します。

ドメインビューから、非機能要件ビューまではアーキテクチャ設計書同様に記載します。

つづいて、予算編で説明したコンポーネント図をもとにベースとする配置ビューを作成し、ドメイン駆動設計とクリーンアーキテクチャをベースとした論理レイヤーの「たたき台（最終形ではない）」を作成・説明します。ここでは配置ビューも論理ビューも完成形まであえて持っていきません。

そのうえで、ユースケース上基本となるパターンの代表的なユースケースをどう実装するか（つまり実装ビューを作りながら）、配置ビューと論理ビューを更新します。

最後に、CIや自動テストなどの非機能要件の実現方法を検討しながら、配置ビューと論理ビューの最終形を設計する、という構成で記載します。

ではさっそく行きましょう！